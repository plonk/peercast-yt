{^define LAYOUT layout.html}
{^define TITLE}
  {#Channels} - {#PeerCast on} {^SERVER_NAME}
{^end}
{^define HEAD}
  <style>
   input, select { font-size: 9pt }
   .channel-list {
       font-family: Verdana, sans-serif; font-size: 9pt; color: #222; line-height: 1.3em; margin: 0;
       width:100%; max-width: 640px
    }
   .channel-list tr { background-color: #FFECC4 }
   .channel-list th { font-size: 9pt; padding: 3px 5px; color: black }
   .channel-list th a { color: inherit }
   .channel-list td { text-align: center; padding: 5px 5px; }
   .channel-list td.channel-description {
       text-align: left;
       overflow-wrap: break-word;
   }
   td.results { text-align: left }
   .link { color: blue }
   .em-link { color: blue; font-weight: bold }
   .container { background-color: white;
          margin-left: auto; margin-right: auto;
          border: solid 1px black; padding: 5px }
   .channel-name { font-size: 11pt; margin-bottom: 2px }
   .detail {  }
   .rank { font-size: 9pt }
   .listeners { padding-bottom: 3px }
   .icons { margin-top: 2px }
   .play-button { margin-left: 8px; margin-right: 8px }
   .channel-list .bitrate { text-align: right }
   .relay-list { width:100%; max-width: 640px }
   .relay-list th { white-space: nowrap }
   .accented { color: var(--accent-color) !important; }
   .muted { color: grey !important; }
    {^DARK_THEME_STYLES_BEGIN}
        .channel-list { color: #ddd }
        .channel-list tr { background-color: #544827 }
        .channel-list th { color: #eee }
    {^DARK_THEME_STYLES_END}
  </style>
{^end}

<a href="/admin?cmd=fetch_feeds" title="{#Auto-updates every 5 minutes. Manual updates have a cooldown of 30 seconds.}">{#Update}</a>

<!-- index.txt の取得が5分ごとなので、あまり頻繁に更新しても仕方ない -->
<div class="reloader hscroll" data-url="channels.html?fragment=channels&{$request.queryString}" data-interval="60">
  {@fragment channels}
  <table class="channel-list">
    <tr>
      <th>
        <a class='{$ if(page.sort_by=="name", "accented") }' href="?sort_by=name&order=asc">{#Channel}</a>
        <a class='sort-triangle {$ if(and(page.sort_by=="name",page.order=="desc"), "accented", "muted") }' href="?sort_by=name&order=desc">▼</a>
        <a class='sort-triangle {$ if(and(page.sort_by=="name",page.order=="asc"), "accented", "muted") }' href="?sort_by=name&order=asc">▲</a>
      </th>
      <th>
        <a class='{$ if(page.sort_by=="numDirects", "accented") }' href="?sort_by=numDirects&order=desc">{#Status}</a>
        <a class='sort-triangle {$ if(and(page.sort_by=="numDirects",page.order=="desc"), "accented", "muted") }' href="?sort_by=numDirects&order=desc">▼</a>
        <a class='sort-triangle {$ if(and(page.sort_by=="numDirects",page.order=="asc"), "accented", "muted") }' href="?sort_by=numDirects&order=asc">▲</a>
      </th>
      <th>
        <a class='{$ if(page.sort_by=="bitrate", "accented") }' href="?sort_by=bitrate&order=desc">{#Bitrate}</a>
        <a class='sort-triangle {$ if(and(page.sort_by=="bitrate",page.order=="desc"), "accented", "muted") }' href="?sort_by=bitrate&order=desc">▼</a>
        <a class='sort-triangle {$ if(and(page.sort_by=="bitrate",page.order=="asc"), "accented", "muted") }' href="?sort_by=bitrate&order=asc">▲</a>
      </th>
      <th>
        <a class='{$ if(page.sort_by=="contentTypeStr", "accented") }' href="?sort_by=contentTypeStr&order=asc">{#Type}</a>
        <a class='sort-triangle {$ if(and(page.sort_by=="contentTypeStr",page.order=="desc"), "accented", "muted") }' href="?sort_by=contentTypeStr&order=desc">▼</a>
        <a class='sort-triangle {$ if(and(page.sort_by=="contentTypeStr",page.order=="asc"), "accented", "muted") }' href="?sort_by=contentTypeStr&order=asc">▲</a>
      </th>
    </tr>

    {@foreach channels}
    <tr>
      <td class="channel-description">
	<a {@if this.id != "00000000000000000000000000000000"}href="play.html?id={$this.id}"{@end} style="display: block; text-decoration: none; max-width: 45vw">
          <div class="channel-name">
            {!this.name}
          </div>
          <div class="detail text-muted">
            {@if this.genre}{!this.genre} - {@end}{!this.desc}
          </div>
	</a>
      </td>
      <td align=center nowrap>
        <span class="listeners">
          {$this.numDirects}/{$this.numRelays}
        </span>
        {@if this.encodedName}
        <div class="icons">
          <a href="{$this.chatUrl}"><img alt="Chat" src="/assets/images/chat.png"></a>
          <a href="{$this.statsUrl}"><img alt="Stats" src="/assets/images/graph.png"></a>
        </div>
        {@end}
      </td>
      <td class="bitrate" align=center nowrap>
        {$this.bitrate} kb/s
      </td>
      <td align=center>
        {$this.contentTypeStr}
      </td>
    </tr>
    {@end}
  </table>
  {@end} <!-- fragment content -->
</div>
